<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Hierarchical Clustering · PhyloClustering.jl</title><meta name="title" content="Hierarchical Clustering · PhyloClustering.jl"/><meta property="og:title" content="Hierarchical Clustering · PhyloClustering.jl"/><meta property="twitter:title" content="Hierarchical Clustering · PhyloClustering.jl"/><meta name="description" content="Documentation for PhyloClustering.jl."/><meta property="og:description" content="Documentation for PhyloClustering.jl."/><meta property="twitter:description" content="Documentation for PhyloClustering.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PhyloClustering.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../man/installation/">Installation</a></li><li><a class="tocitem" href="../../lib/bipartition/">Split-Weight Embedding</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../basic/">Basics</a></li><li><a class="tocitem" href="../kmeans/">K-means</a></li><li class="is-active"><a class="tocitem" href>Hierarchical Clustering</a><ul class="internal"><li><a class="tocitem" href="#Example"><span>Example</span></a></li></ul></li><li><a class="tocitem" href="../dbscan/">DBSCAN</a></li><li><a class="tocitem" href="../gmm/">Gaussian Mixture Model (GMM)</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../lib/helper_methods/">Helper Functions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Models</a></li><li class="is-active"><a href>Hierarchical Clustering</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Hierarchical Clustering</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/solislemuslab/PhyloClustering.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/solislemuslab/PhyloClustering.jl/blob/master/docs/src/model/hclust.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Hierarchical-Clustering"><a class="docs-heading-anchor" href="#Hierarchical-Clustering">Hierarchical Clustering</a><a id="Hierarchical-Clustering-1"></a><a class="docs-heading-anchor-permalink" href="#Hierarchical-Clustering" title="Permalink"></a></h1><p><a href="https://en.wikipedia.org/wiki/Hierarchical_clustering">Hierarchical clustering</a> is a hierarchical method that creates a clustering tree called a dendrogram. Each leaf on the tree is a data point, and branches represent the joining of clusters. We can &#39;cut&#39; the tree at different heights to get a different number of clusters. This method does not require the number of clusters to be specified in advance and can be either agglomerative (bottom-up) or divisive (top-down).</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PhyloClustering.hc_label" href="#PhyloClustering.hc_label"><code>PhyloClustering.hc_label</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">hc_label(matrix::AbstractMatrix{&lt;:Real}, n::Int64; linkage::Symbol=:ward)</code></pre><p>Get predicted labels from hierarchical clustering for a group of phylogenetic trees.</p><p><strong>Arguments</strong></p><ul><li><code>matrix</code>: a N * N pairwise distance Matrix.</li><li><code>n</code>: the number of clusters.</li><li><code>linkage</code>(defaults to <code>:ward</code>): cluster linkage function to use. It affects what clusters are merged on each iteration:<ul><li><code>:single</code>: use the minimum distance between any of the cluster members</li><li><code>:average</code>: use the mean distance between any of the cluster members</li><li><code>:complete</code>: use the maximum distance between any of the members</li><li><code>:ward</code>: the distance is the increase of the average squared distance of a point to its cluster centroid after merging the two clusters</li><li><code>:ward_presquared</code>: same as <code>:ward</code>, but assumes that the distances in <code>d</code> are already squared.</li></ul></li></ul><p><strong>Output</strong></p><p>A <code>Vector</code> object with length of N containing predicted labels for each tree (the cluster it belongs to). </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/solislemuslab/PhyloClustering.jl/blob/8f1315437b2198ad97889d290be46f06ec88d75d/src/models.jl#L49-L65">source</a></section></article><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><pre><code class="language-julia hljs">using PhyloClustering, PhyloNetworks

# read trees with 4-taxa in Newick format using PhyloNetworks
trees = readMultiTopology(&quot;../data/data.trees&quot;);

# convert trees to Bipartition foramt and embed them via split-weight embedding
trees = split_weight(trees, 4);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">200×7 Matrix{Float64}:
 2.073  2.073  2.492  7.764  0.419  0.0   0.0
 1.084  1.084  2.035  6.046  0.95   0.0   0.0
 1.234  1.234  2.1    6.221  0.865  0.0   0.0
 2.457  2.064  2.064  6.042  0.0    0.0   0.393
 1.692  1.692  2.836  5.67   1.144  0.0   0.0
 2.664  2.774  2.664  6.598  0.0    0.11  0.0
 1.085  1.085  2.172  5.879  1.087  0.0   0.0
 1.78   1.78   2.054  6.221  0.273  0.0   0.0
 2.123  2.083  2.083  8.856  0.0    0.0   0.04
 1.155  1.155  2.113  7.139  0.959  0.0   0.0
 ⋮                                  ⋮     
 0.663  0.663  3.492  3.492  3.853  0.0   0.0
 1.607  1.607  3.59   3.59   3.143  0.0   0.0
 0.887  0.887  3.826  3.826  3.513  0.0   0.0
 1.053  1.053  3.206  3.206  4.783  0.0   0.0
 0.592  0.592  3.322  3.322  7.53   0.0   0.0
 0.718  0.718  3.335  3.335  5.665  0.0   0.0
 1.46   1.46   3.241  3.241  3.417  0.0   0.0
 0.709  0.709  3.71   3.71   4.774  0.0   0.0
 1.113  1.113  3.402  3.402  5.019  0.0   0.0</code></pre><p>Standardize the data, calculate the distance matrix, and input them into Yinyang K-means clustering.</p><pre><code class="language-julia hljs">tree = standardize_tree(trees);
matrix = distance(tree);
label = hc_label(matrix, 2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">200-element Vector{Int64}:
 1
 1
 1
 1
 1
 1
 1
 1
 1
 1
 ⋮
 2
 1
 2
 2
 2
 2
 1
 2
 2</code></pre><p>We can visualize the result using build-in function <a href="../../lib/helper_methods/#PhyloClustering.plot_clusters"><code>plot_clusters</code></a>.</p><pre><code class="language-julia hljs">plot_clusters(trees&#39;, label)</code></pre><img src="23346757.png" alt="Example block output"/><p><strong>Reference</strong></p><p>The implementation of <em>hierarchical clustering</em> is provided by <a href="https://github.com/JuliaStats/Clustering.jl"><code>Clustering.jl</code></a>.</p><blockquote><p>Joe H. Ward Jr. (1963) <em>Hierarchical Grouping to Optimize an Objective Function</em>,  Journal of the American Statistical Association, 58:301, 236-244, DOI: 10.1080/01621459.1963.10500845</p></blockquote></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../kmeans/">« K-means</a><a class="docs-footer-nextpage" href="../dbscan/">DBSCAN »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Friday 29 December 2023 04:10">Friday 29 December 2023</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
